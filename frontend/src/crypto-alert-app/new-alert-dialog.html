<link rel="import" href="../../bower_components/paper-item/paper-item.html"/>
<link rel="import" href="../../bower_components/paper-dropdown-menu/paper-dropdown-menu.html"/>
<link rel="import" href="../../bower_components/paper-listbox/paper-listbox.html"/>
<link rel="import" href="../../bower_components/paper-radio-button/paper-radio-button.html"/>
<link rel="import" href="../../bower_components/iron-selector/iron-selector.html"/>

<link rel="import" href="form-element-behavior.html"/>
<link rel="import" href="currencies-menu.html"/>
<link rel="import" href="radio-menu.html"/>
<link rel="import" href="single-currency-form.html"/>


<dom-module id="new-alert-dialog">
  <template>
    <style>
      :host {
        @apply --layout-vertical;
      }

      #dialog {
        margin: 0;
      }

      app-toolbar {
        @apply --layout-flex;
        font-size: 15px;
        background-color: rgba(246, 242, 253, 0.51);
        max-height: 30px;
        margin-top: 0;
      }

      paper-item {
        cursor: pointer;
      }

      .buttons {
        @apply --layout-flex;
      }

      .first {
        @apply --layout-vertical;
        margin-top: 15px;
      }
    </style>

    <paper-dialog id="dialog"
                  always-on-top
                  entry-animation="scale-up-animation"
                  exit-animation="fade-out-animation"
                  on-iron-overlay-closed=_clearForms
                  no-cancel-on-outside-click>

      <app-toolbar>
        <div main-title>New alert</div>
      </app-toolbar>

      <iron-pages id="pages1" selected="0">
        <iron-selector id="buttons" class="buttons first" on-iron-select=_openForm>
          <paper-item>Periodic updates</paper-item>
          <paper-item>Follow one currency</paper-item>
        </iron-selector>
        <iron-pages id="pages2">
          <div>toto</div>
          <single-currency-form id="single"></single-currency-form>
        </iron-pages>
      </iron-pages>

    </paper-dialog>

  </template>

  <script>
      class NewAlertDialog extends Polymer.Element {
          static get is() {
              return 'new-alert-dialog';
          }

          open() {
              this.$.buttons.select();
              setTimeout(() => this.$.dialog.open());
          }

          close() {
              this.$.dialog.close();
          }


          _selectPagesAndFit(i, j) {
              this.$.pages1.select(i);
              this.$.pages2.select(j);
              this.$.dialog.resetFit();
              this.$.dialog.center();
          }

          _openForm(e) {
              this._selectPagesAndFit(1, 1);
              e.stopPropagation();
          }

          _clearForms(e) {
              if (e.target === this.$.dialog) {
                  this.$.single.clearForm();
                  setTimeout(() => this._selectPagesAndFit(0, 1));
              }
          }
      }

      window.customElements.define('new-alert-dialog', NewAlertDialog);
  </script>
</dom-module>